<div class="container detail-container">
  
  <!-- Mensajes de Carga y Error -->
  <div *ngIf="isLoading" class="loading-spinner">Cargando detalles de la reserva...</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <!-- Contenido principal (usando el pipe async) -->
  <ng-container *ngIf="(booking$ | async) as booking; else noBooking">
    <div class="card">
      <div class="card-header" [ngClass]="'status-' + booking.status.toLowerCase()">
        <h2>Detalles de la Reserva</h2>
        <span class="status-badge">{{ booking.status }}</span>
      </div>
      <div class="card-body">
        <div class="detail-item">
          <span class="label">ID de Reserva:</span>
          <span class="value">#{{ booking.bookingUuid }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Servicio:</span>
          <span class="value">{{ booking.serviceName }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Reservado por:</span>
          <span class="value">{{ booking.clientUsername }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Fecha:</span>
          <span class="value">{{ booking.startTime | date:'fullDate':'':'es' }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Horario:</span>
          <span class="value">{{ booking.startTime | date:'shortTime' }} - {{ booking.endTime | date:'shortTime' }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Precio Pagado:</span>
          <span class="value">{{ booking.pricePaid | currency:'EUR' }}</span>
        </div>
        <div class="detail-item notes" *ngIf="booking.notes">
          <span class="label">Notas:</span>
          <p class="value">{{ booking.notes }}</p>
        </div>
        <div class="detail-item created-at">
          <span class="label">Reserva creada el:</span>
          <span class="value">{{ booking.createdAt | date:'medium':'':'es' }}</span>
        </div>
      </div>
      <div class="card-footer">
        <button class="btn btn-outline-secondary" (click)="goBack()">Volver</button>
        <a routerLink="/home" class="btn btn-primary">Ir al Panel Principal</a>
      </div>
    </div>
  </ng-container>

  <!-- Estado por defecto si no se encuentra el booking -->
  <ng-template #noBooking>
    <div *ngIf="!isLoading && !errorMessage" class="placeholder-text">
      No se han podido cargar los datos de la reserva.
    </div>
  </ng-template>

</div>